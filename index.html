<!doctype html><html lang=en-QS><meta id=Ý½ charset=utf-8>
<meta name=viewport content="width=device-width, height=device-height, initial-scale=1">

<title>Markup2 Demo</title>

<script src=langs.js></script>
<script src=parse.js></script>
<script src=legacy.js></script>
<script src=render.js></script>
<script src=runtime.js></script>
<script src=helpers.js></script>
<link rel=stylesheet href=markup.css>

<script src=testing/textarea.js></script>
<link rel=stylesheet href=testing/common.css>
<script src=testing/tree.js></script>
<link rel=stylesheet href=testing/tree.css>

<style>
	table.times {
		width: 100%;
	}
	table.times, table.times td, table.times th {
		color: black;
		border: 1px solid currentColor;
		border-spacing: 0;
	}
	table.times td, table.times th {
		padding: 2px 5px;
		word-break: normal; overflow-wrap: break-word;
	}
	table.times td {
		color: black;
		background: white;
	}
	table.times th {
		font-weight: bold;
		color: white;
		background: black;
	}
	table-overflow {
		overflow-x: auto;
		background: #222;
		color: #FFF;
	}
	
	#\$output {
		border: 3px solid black;
		padding: 2px;
		overflow-y: auto;
	}
	#\$inputs {
		flex-wrap: wrap;
		gap: .25em;
		background: #222;
		color: #FFF;
		padding: 2px;
	}
	
	label {
		align-self: center;
		font-weight: bold;
	}
</style>

<body class='Col'>
<script src=testing/nav.js></script>

<main class='fill Split'>
	<input-pane class='Col'>
		<div class='Row' id=$inputs>
			<select id=$lang value=12y2>
				<option> 12y2
				<option> 12y
				<option> bbcode
				<option value=plaintext> plain
			</select>
			<span class='fill'></span>
			<select id=$display value=render>
				<option> render
				<option> nodes
				<option> json
			</select>
		</div>
		
		<textarea-container class='limit'>
			<textarea id=$input></textarea>
		</textarea-container>
	</input-pane>
	
	<output-pane class='Col'>
		<table-overflow><table class='times'>
			<tr>
				<th> <th> parse <th> render <th> layout <th> total
			<tr>
				<th> ms
				<td> <time id=$time1 datetime=Z></time>
				<td> <time id=$time2 datetime=Z></time>
				<td> <time id=$time3 datetime=Z></time>
				<td> <time id=$time4 datetime=Z></time>
		</table></table-overflow>
		<span id=$count></span>
		<div id=$output class='Markup limit'></div>
	</output-pane>
</main>

<script>
	function show_time(elem, ms) {
		elem.dateTime = (ms/1000).toFixed(4)+' s'
		elem.textContent = ms.toFixed(1)
	}
	
	function update() {
		//Markup.convert_lang($input.value, $lang.value, $output)
		let t0, t1, t2, t3
		t0 = performance.now()
		let tree = Markup.langs.parse($input.value, $lang.value)
		t1 = performance.now()
		if ('render'==$display.value) {
			$output.replaceChildren(Markup.renderer.render(tree))
		} else if ('nodes'==$display.value) {
			let e = draw_tree(tree)
			$output.replaceChildren(e)
		} else if ('json'==$display.value) {
			$output.textContent = JSON.stringify(tree)
		}
		t2 = performance.now()
		$output.scrollHeight
		t3 = performance.now()
		show_time($time1, t1-t0)
		show_time($time2, t2-t1)
		show_time($time3, t3-t2)
		show_time($time4, t3-t0)
	}
	
	setup_textarea($input, update)
	
	$lang.onchange = update
	$display.onchange = update
	update()
</script>
